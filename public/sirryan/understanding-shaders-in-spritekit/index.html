

	


<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
	<title>Battle of Brothers | A Video Game Programming Duel</title>
	<meta name="description" content="Follow Chris and Ryan as they design indie video game software using the Corona SDK and Sprite Kit frameworks in this game programming duel.">
	<meta name="keywords" content=“video,game,programming,software, design, corona, sprite kit, indie”>
	<meta name="author" content="Battle of Brothers">
	<meta name="robots" content="index, follow">
	  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover">

  


   	 <link rel="stylesheet" href="/css/ryan.css?v=1'; ?>" type="text/css" media="screen" />
    <link rel="stylesheet" href="/css/global.css" type="text/css" media="screen" />





  <link rel="stylesheet" href="/css/post.css?v=1'; ?>" type="text/css" media="screen" />


<script src="/js/index-min.js"></script>

  

  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-18183842-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-18183842-5');
</script>
</head>
  <body class="home gradient">

    

  	

<div class="top">
	<div class="breadcrumb">
		<p>Currently following
		
		<a href="/sirryan" title="Hurrah!" class="dotted">Sir Ryan</a></p> 
		<p><a href="/sirchris" title="To see what the losing team is up to." class="switch chris">See what Sir Chris is up to &#8611;</a></p>
		
	</div>
</div>



  	


	


<header class="content normalHeader">
	<a class="ryanshield rotate " href="/sirryan">
		<img class="" style="" src="/assets/RyanShield.png" />
	</a>

	
	<a class="mainshield" href="/">
		<img alt="The one year game develpoment duel" src="/assets/Banner.png" width="266px" class="" />
	</a>
	

	<a class="chrisshield counterrotate" href="/sirchris">
		<img style="" src="/assets/ChrisShield.png" />
	</a>

</header> 

<header class="content mobileHeader">

	
		<img class="" style="" src="/assets/RyanShield.png" />
	

</header>

  	
<nav class="site">
	
		<div class="navcontainer clear blog">
	
  		<div class="clear navbox leftnav">
  			<span>
	  			<a href="/sirryan" class="blog clear">
	  				<img class="" src="/assets/Castle.png" width="16px" />Sir Ryan
	  			</a>
  			</span>
			<span>
	  			<a href="/sirryan/timeline" class="timeline clear">
	  				<img class="" src="/assets/Boom.png" width="16px"  />Timeline
	  			</a>
  			</span>
			<span>
	  			<a href="/sirryan/budget" class="budget clear">
	  				<img class="" src="/assets/Money-5.png" width="16px"  />Budget
	  			</a>
  			</span>
		</div>
		<div class="clear navbox">
			<span>
	  			<a href="/sirryan/contact" class="contact clear">
	  				<img class="" src="/assets/Game-Controller.png" width="16px"  />Contact
	  			</a>
  			</span>
			<span>
	  			<a href="/sirryan/subscribe" class="subscribe clear">
	  				<img class="" src="/assets/RSS.png" width="16px"  />Subscribe
	  			</a>
  			</span>
			<span>
	  			<a href="/sirryan/about" class="about clear">
	  				<img class="" src="/assets/Pacman-2.png" width="16px"  />About
	  			</a>
  			</span>
		</div>
	</div>
</nav>


    <div class="outercontent">
  	  <div class="content clear">

		<article class="clear">
			<div class="title clear">
				
<div class="floatleft timestamp">
	<span class="month">May</span>
	<p class="shield" style="background-image:url('/assets/Shield12.png')">28</p>
	<span class="year legacy">2015</span>
</div>
				<h3 class="grace">Understanding Shaders in SpriteKit</h3>
				<div class="subhead">
					



	
	
		
	


<span class="comments floatright">
	<img class="icon" src="/assets/Chat-6.png" width="16px" />
	<small><a href="/sirryan/understanding-shaders-in-spritekit/#comments" class="dotted"><span></span>9 comments</a></small>
</span>
<img class="icon" src="/assets/Tag-star.png" width="16px">
<small>
	
	<a href="/sirryan/tags/code" class="dotted">code</a>
	
	<a href="/sirryan/tags/shader" class="dotted">shader</a>
	
	<a href="/sirryan/tags/spritekit" class="dotted">spritekit</a>
	
</small>
				</div>
			</div>

			

			
				
			
				
			
				
			

			<div class="post source_light">		
				
 				<p>If you&#8217;re new to game development, you&#8217;ve probably heard of shaders but don&#8217;t quite understand them. If you&#8217;re new to SpriteKit, you&#8217;ve probably hit a few speed bumps working with shaders. Since I&#8217;m still learning more about the two, I figured it would be nice to put up a concrete example that covers cropping and effects using shaders. Specifically, we&#8217;ll cover two concepts:
</p>

<ul>
<li>Using alpha, black, and white pixel values to determine which pixels to display.</li>
<li>Porting shaders found on <a href="https://www.shadertoy.com" target="_blank">Shadertoy</a> into SpriteKit.</li>
</ul>

<p>Here is what it&#8217;ll look like when we&#8217;re done.</p>

<div class="inlineimg">
  <div style='position:relative;padding-bottom:calc(100% / 1.78)'><iframe src='https://gfycat.com/ifr/TemptingSoreAidi' frameborder='0' scrolling='no' width='100%' height='100%' style='position:absolute;top:0;left:0;' allowfullscreen></iframe></div>
</div>

<p>If you have never worked with a shader in SpriteKit before, you should probably check out this <a href="http://chrislanguage.blogspot.com/2015/02/fragment-shaders-with-spritekit.html" target="_blank">quick introductory tutorial</a>. And if you&#8217;re interested in shaders, but not SpriteKit, you may still find a thing or two that grabs you&#8217;re attention.</p>

<h4 id="getting-started">Getting Started</h4>

<div class="embedleft floatleft">
  <img class="alignnone size-full wp-image-2161" style="margin-left: -20px !important;border: none !important" src="http://battleofbrothers.com/wp-content/uploads/2015/05/Melee1HeraldryDark.png" alt="Melee1HeraldryDark" width="117" height="118" />
</div>

<p>The first thing to do is find an image that you would like to mask or modify in some way. For this example, I&#8217;ll be using a circular health bar that wraps around a shield graphic. Note the image is a .png, and that in between the black lines along with the outside is fully transparent. We&#8217;ll try to satisfy three requirements.</p>

<ul>
<li>Only show health in between the two black lines outlining the image.</li>
<li>Allow for the health section to be partially full.</li>
<li>Add movement to the health bar.</li>
</ul>

<h4 id="a-basic-shader">A Basic Shader</h4>

<p>To apply a basic shader to our image, we&#8217;ll need to tell SpriteKit to attach a shader to the SKSpriteNode, and we&#8217;ll also need to create an empty text file ending in .fsh that contains our shader code. First, the shader code:</p>

<script src="//gist.github.com/veeneck241ad4e3b8153b33518d/.js"></script>

<p>Next, attach the shader in SpriteKit:</p>

<script src="//gist.github.com/veeneck3e0292d872a3146d0620/.js"></script>

<div class="embed floatright">
  <img class="alignnone size-full wp-image-2180" style="border: none !important" src="http://battleofbrothers.com/wp-content/uploads/2015/05/Screen-Shot-2015-05-28-at-11.52.26-AM.png" alt="Screen Shot 2015-05-28 at 11.52.26 AM" width="135" height="136" />
</div>

<p>As you can see to the right, the shader turns every pixel green. This is because <code>main()</code> is the entry point, and by default <code>gl_FragColor</code> is the return value. So, for each pixel of the image, this snippet of code runs. And when the code runs, it is telling each pixel that the color should be green (note the r,g,b,a value of the <code>vec4()</code> call).</p>

<h4 id="detecting-alpha-values">Detecting Alpha Values</h4>

<p>Now that we can change the color of pixels, the next step is to only change the color of fully transparent pixels. We&#8217;ll change our shader code to the following:</p>

<script src="//gist.github.com/veeneckf8601f819b5f1ac9c52e/.js"></script>

<div class="embedleft floatleft">
  <img class="alignnone size-full wp-image-2191" style="margin-left: -20px !important;border: none !important" src="http://battleofbrothers.com/wp-content/uploads/2015/05/Screen-Shot-2015-05-28-at-12.08.03-PM.png" alt="Screen Shot 2015-05-28 at 12.08.03 PM" width="133" height="137" />
</div>

<p>Now, our image fully displays, and all transparent pixels have been replaced with green pixels. Specifically, we create <code>val</code> which contains the pixel in the actual texture. The alpha value (<code>val.a</code>) is transparent if it equals 0.0. So, we either replace the pixel with a green one, or set the return value to the pixel from the actual texture.</p>

<h4 id="masking-gradients">Masking &amp; Gradients</h4>

<p>The obvious problem with the previous step is that we have to get rid of everything outside of the circle. We only want to fill the inside. In addition, we want the inside to fill only a percentage equal to the health of the player. We&#8217;re going to add a separate image to act as both an image mask, and a gradient fill.</p>

<div class="inlineimg">
  <img class="alignnone size-full wp-image-2197" src="http://battleofbrothers.com/wp-content/uploads/2015/05/circleshader.png" alt="circleshader" width="117" height="118" />
</div>

<p>First, let&#8217;s talk about the <strong>mask</strong>. This circle is the exact same size as the shield above. So, if a pixel falls inside of both the circle and the shield, we know we want to draw it. If it falls outside, we can get rid of it. That&#8217;s how we&#8217;ll achieve the health bar look.</p>

<p>Second, let&#8217;s talk about the <strong>gradient</strong>. Notice that a radial gradient has been applied with pure black meeting pure white at the top. The general idea here is that we can check pixel colors. Imagine a player with health of 75%. We can check all pixels that are at least 75% black, and turn them on. Anything else gets turned off.</p>

<p>To make these two concepts, we&#8217;ll have to attach <a href="https://developer.apple.com/library/prerelease/ios/documentation/SpriteKit/Reference/SKUniform_Ref/index.html" target="_blank">SKUniform&#8217;s</a> to the shader. Think of this as passing variables through to the shader. In this case, we&#8217;ll need two variables. One for health, and one for the image above. Our Swift code should now look like:</p>

<script src="//gist.github.com/veenecke68c62e4417bfa03a62d/.js"></script>

<p>We&#8217;re basically supplying a float and SKTexture to the shader. Then, we can modify the shader to produce our desired result.</p>

<script src="//gist.github.com/veeneck23854616813f74819d66/.js"></script>

<p>Here is the result:</p>

<div class="inlineimg">
  <img class="alignnone size-full wp-image-2201" src="http://battleofbrothers.com/wp-content/uploads/2015/05/Screen-Shot-2015-05-28-at-10.47.08-AM.png" alt="Screen Shot 2015-05-28 at 10.47.08 AM" width="152" height="155" />
</div>

<p>A few notes on the inline code comments:</p>

<p><strong>[1]</strong> At the beginning of this tutorial, we checked <code>val.a == 0.0</code> and now we&#8217;re checking <code>val.a less than 0.1</code>. This is because there are partially transparent pixels around the edges of the circle that we&#8217;re being excluded. A limit of 0.1 set the best result.</p>

<p><strong>[2]</strong> You can test the black value of a pixel against any of the r, g, b values of the vec4. I just used <code>.r</code> because that is what I&#8217;ve seen the most.</p>

<p><strong>[3] </strong>Similar to [1], I could have check the mask for pixels that are fully visible where <code>grad.a == 1.0</code>, but a tolerance was needed to produce the best results.</p>

<h4 id="porting-from-shadertoy">Porting From Shadertoy</h4>

<p>When browsing <a href="https://www.shadertoy.com" target="_blank">Shadertoy</a>, you&#8217;ll notice certain variables that aren&#8217;t available to you, or that break your script. Here are the most common ones I&#8217;ve seen, and how to use them in SpriteKit.</p>

<table cellspacing="20" cellpadding="15">
  <tr>
    <td>
      iGlobalTime
    </td>
    
    <td>
      <strong>u_time</strong>
    </td>
  </tr>
  
  <tr>
    <td>
      iResolution
    </td>
    
    <td>
      <strong>u_sprite_size</strong>
    </td>
  </tr>
  
  <tr>
    <td>
      fragCoord.xy
    </td>
    
    <td>
      <strong>gl_FragCoord.xy</strong>
    </td>
  </tr>
  
  <tr>
    <td>
      iChannelX
    </td>
    
    <td>
      <strong>SKUniform with name of &#8220;iChannelX&#8221; containing SKTexture</strong>
    </td>
  </tr>
  
  <tr>
    <td>
      fragColor
    </td>
    
    <td>
      <strong>gl_FragColor</strong>
    </td>
  </tr>
</table>

<h4 id="using-existing-animation-examples">Using Existing Animation Examples</h4>

<p>Now that we know how to port from Shadertoy, let&#8217;s try it with a few examples.</p>

<p><strong>Example 1: </strong><a href="https://www.shadertoy.com/view/Xtl3Dj" target="_blank">Bullseye</a></p>

<div class="inlineimg">
  <div style='position:relative;padding-bottom:calc(100% / 1.78)'><iframe src='https://gfycat.com/ifr/EdibleDapperDorking' frameborder='0' scrolling='no' width='100%' height='100%' style='position:absolute;top:0;left:0;' allowfullscreen></iframe></div>
</div>

<script src="//gist.github.com/veeneck8181776f76a112dce239/.js"></script>

<p><strong>Example 2:</strong> <a href="https://www.shadertoy.com/view/XtsGDj" target="_blank">Wobble Spiral</a></p>

<div class="inlineimg">
  <div style='position:relative;padding-bottom:calc(100% / 1.78)'><iframe src='https://gfycat.com/ifr/UnselfishRemarkableJenny' frameborder='0' scrolling='no' width='100%' height='100%' style='position:absolute;top:0;left:0;' allowfullscreen></iframe></div>
</div>

<script src="//gist.github.com/veeneckeb5c947bc6d8f1efd598/.js"></script>

<p><strong>Example 3: </strong><a href="https://www.shadertoy.com/view/4lB3DG" target="_blank">Glowing Thing</a></p>

<div class="inlineimg">
  <div style='position:relative;padding-bottom:calc(100% / 1.78)'><iframe src='https://gfycat.com/ifr/MixedMildGroundbeetle' frameborder='0' scrolling='no' width='100%' height='100%' style='position:absolute;top:0;left:0;' allowfullscreen></iframe></div>
</div>

<script src="//gist.github.com/veeneck21d480aae49482975efe/.js"></script>

<h4 id="further-reading-next-steps">Further Reading &amp; Next Steps</h4>

<p>Resources:</p>

<ul>
<li><a href="http://www.ymc.ch/en/making-a-pixel-shader-for-ios8-with-sprite-kit" target="_blank">Making a Pixel Shader for iOS8 with SpriteKit</a></li>
<li>Hub.ae&#8217;s <a href="https://www.youtube.com/watch?v=rd7pEru73IY" target="_blank">shader intro</a> and <a href="https://www.youtube.com/watch?v=eYHId0zgkdE" target="_blank">bloom/blur tutorial</a>.</li>
<li><a href="https://developer.apple.com/library/prerelease/ios/documentation/SpriteKit/Reference/SKShader_Ref/index.html" target="_blank">SKShader documentation</a>.</li>
<li><a href="https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&uact=8&ved=0CCkQFjAB&url=http%3A%2F%2Fdevstreaming.apple.com%2Fvideos%2Fwwdc%2F2014%2F606xxql3qoibema%2F606%2F606_whats_new_in_sprite_kit.pdf%3Fdl%3D1&ei=czBnVem6F4PUsAWIpICIBA&usg=AFQjCNE3zOLO0kl8CGsMp_nYpK3vvkXamQ&sig2=VJ7m_6UL2Sh-S_69dwuEFA&bvm=bv.93990622,d.b2w" target="_blank">WWDC14 PDF</a></li>
<li><a href="https://www.khronos.org/opengles/sdk/docs/reference_cards/OpenGL-ES-2_0-Reference-card.pdf" target="_blank">OpenGL ES 2.0 API Quick Reference Card</a></li>
<li>Alternative to Shadertoy: <a href="http://glslsandbox.com" target="_blank">GLSLSandbox</a></li>
</ul>

<p>Beyond this, I&#8217;m still interested in the performance of shaders, and confidently knowing when to use them. For example, the 6th shader in the original gif above starts to lag a bit if you leave it running too long. Is it because of poor code, or is it too intensive? Similarly, would it be better to use 20 static images to represent health chunks of the circle, and just manage the health bar in code? I&#8217;ve often heard that using shaders is the &#8220;right way&#8221;, but I&#8217;d like to know with certainty when that is true. Perhaps another part to this tutorial is in order.</p>
			</div>

		</article>

	</div>
</div>

<div class="outercontentalt">
  	<div class="content clear">

  		<div id="discuss" class="discuss">
			<img class="" src="/assets/discuss.png" />
		</div>

	  
	  
	  
	  	
	  	
		    <h5 class="grace comment-count"><span class="legacy">9</span> of you did not hold your tongue!</h5>
			<ol id="comments" class="commentlist">
		  		
		    		

		    			


<li >
	<div class="comment-body">
		<div class="comment-author vcard">
			<img src="https://www.gravatar.com/avatar/2838fd8cbe83af733dfb3658a886324b?s=118&d=http://battleofbrothers.com/assets/comment_av_6.png" alt="" class="avatar avatar-64 photo" height="118" width="118">
		</div>
		<div class="comment-wrapper">
			
				<p>As far as the 6th shader is concerned, the common wisdom, as far as I know, is to avoid if conditionals (seems to be less of a problem now), trigonometric functions, since those take a lot of instructions to execute (quite often people use look up textures to skip those computations on the GPU and some say that trigonometric on the GPU aren&#39;t that bad any more) and doing too many calculations in one line, since the driver is probably generating a lot of temporary variables to perform those (if you&#39;re interested, check out these GDC slides <a href="http://www.gdcvault.com/play/1018182/Low-Level-Thinking-in-High">http://www.gdcvault.com/play/1018182/Low-Level-Thinking-in-High</a>).
If I had to guess where the lag is coming from, I&#39;d say it&#39;s either a precision issue with the time float or the trigonometric function start to get wonky with higher number ranges.
To answer your larger question, in my opinion using shaders is great if you want to use less memory and want a smooth animation, I also think it&#39;s nice, that all that&#39;s needed, is setting just one uniform in a shader.
If your shaders are getting too complex or you want to add special details by hand a sprite sheet may be better. I also prefer shaders since there has to be less redundant data in memory, given that a lot of the pixels in a sprite sheet probably aren&#39;t changing.
If your shaders are performing badly look into calculating data higher up the chain, for instance maybe you can do calculations per vertex and have the results interpolated over the fragments or calculate data on the cpu and save the results in a look up texture, so that the gpu just has to do a texture lookup.</p>
			
		</div>
		<div class="comment-meta commentmetadata">
			<a href="#">#</a> by 
			<cite class="fn">
				
				    Stefan Kernjak
				
			</cite> Jun 13, 2015
		</div>
		<div class="reply">
			<a id="1577" class="btn-info comment-reply-link" href="#comment-form" onclick="changeValue('fields[reply_to]', '1577')">Reply</a>
		</div>
	</div>
</li>

<ul class="children">

  

  

  

  

  

  

  

  

  

</ul> 

		    		
		  		
		    		

		    			


<li >
	<div class="comment-body">
		<div class="comment-author vcard">
			<img src="https://www.gravatar.com/avatar/05978af77955fdd863082dbae2ec8b8c?s=118&d=http://battleofbrothers.com/assets/comment_av_8.png" alt="" class="avatar avatar-64 photo" height="118" width="118">
		</div>
		<div class="comment-wrapper">
			
				<p>Thanks for the detailed reply. That&#39;s helpful to place some rules into the thought process. The link you provided is a bit above my head right now. Still some work to do before I can comfortably process that. I&#39;ll get there eventually.</p>
			
		</div>
		<div class="comment-meta commentmetadata">
			<a href="#">#</a> by 
			<cite class="fn">
				
				    veeeneck
				
			</cite> Jun 15, 2015
		</div>
		<div class="reply">
			<a id="1586" class="btn-info comment-reply-link" href="#comment-form" onclick="changeValue('fields[reply_to]', '1586')">Reply</a>
		</div>
	</div>
</li>

<ul class="children">

  

  

  

  

  

  

  

  

  

</ul> 

		    		
		  		
		    		

		    			


<li >
	<div class="comment-body">
		<div class="comment-author vcard">
			<img src="https://www.gravatar.com/avatar/3d5d99c17fdbfd705b0182e9866d3a77?s=118&d=http://battleofbrothers.com/assets/comment_av_12.png" alt="" class="avatar avatar-64 photo" height="118" width="118">
		</div>
		<div class="comment-wrapper">
			
				<p>Thanks a lot for that article!  I&#39;m quite new to game developement (i&#39;ve been coding for years though), Swift and SpriteKit so we are pretty much in the same spot.  I&#39;m working on a space exploration game and I was wondering if shaders would be helpful for a few things.  I&#39;m not quite there yet, but when I start attacking the subject, maybe I can share some of my findings since I would be probably using shaders along with SKShapeNodes and SKEmitterNodes.
Anyway, thanks a lot for the insight!  Very helpful!
One question though:  in your case, do you create the textures and shader every time the player&#39;s health change?  Can you simply change the uniform&#39;s values and the shader will adjust everything by itself every frame?</p>
			
		</div>
		<div class="comment-meta commentmetadata">
			<a href="#">#</a> by 
			<cite class="fn">
				
				    BadgerBadger
				
			</cite> Nov 26, 2016
		</div>
		<div class="reply">
			<a id="1595" class="btn-info comment-reply-link" href="#comment-form" onclick="changeValue('fields[reply_to]', '1595')">Reply</a>
		</div>
	</div>
</li>

<ul class="children">

  

  

  

  

  

  

  

  

  

</ul> 

		    		
		  		
		    		

		    			


<li >
	<div class="comment-body">
		<div class="comment-author vcard">
			<img src="https://www.gravatar.com/avatar/5e98cd902659f82e19065c13ef80356c?s=118&d=http://battleofbrothers.com/assets/comment_av_11.png" alt="" class="avatar avatar-64 photo" height="118" width="118">
		</div>
		<div class="comment-wrapper">
			
				<p>You should be able to just update the uniforms. I don&#39;t remember recreating the shader, but I don&#39;t have my sample code handy. Would definitely love to see what you come up with &ndash; there isn&#39;t much activity with advanced SpriteKit out there, so any content you come up with would be nice to read.</p>
			
		</div>
		<div class="comment-meta commentmetadata">
			<a href="#">#</a> by 
			<cite class="fn">
				
				    veeeneck
				
			</cite> Nov 27, 2016
		</div>
		<div class="reply">
			<a id="1604" class="btn-info comment-reply-link" href="#comment-form" onclick="changeValue('fields[reply_to]', '1604')">Reply</a>
		</div>
	</div>
</li>

<ul class="children">

  

  

  

  

  

  

  

  

  

</ul> 

		    		
		  		
		    		

		    			


<li >
	<div class="comment-body">
		<div class="comment-author vcard">
			<img src="https://www.gravatar.com/avatar/1cec8256586ca35bb538a6ecafb35f4b?s=118&d=http://battleofbrothers.com/assets/comment_av_7.png" alt="" class="avatar avatar-64 photo" height="118" width="118">
		</div>
		<div class="comment-wrapper">
			
				<p>I might be completely wrong but it seems like the gradient or something does not work since iOS 10. Or something has changed. Or my implementation (a bit different) is incorrect. Can you confirm that this works in iOS 10 (iOS 10.2 etc) still?</p>
			
		</div>
		<div class="comment-meta commentmetadata">
			<a href="#">#</a> by 
			<cite class="fn">
				
				    
				
			</cite> Jan 25, 2017
		</div>
		<div class="reply">
			<a id="1616" class="btn-info comment-reply-link" href="#comment-form" onclick="changeValue('fields[reply_to]', '1616')">Reply</a>
		</div>
	</div>
</li>

<ul class="children">

  

  

  

  

  

  

  

  

  

</ul> 

		    		
		  		
		    		

		    			


<li >
	<div class="comment-body">
		<div class="comment-author vcard">
			<img src="https://www.gravatar.com/avatar/3b44126f7916d3aa1dc62107036151d0?s=118&d=http://battleofbrothers.com/assets/comment_av_12.png" alt="" class="avatar avatar-64 photo" height="118" width="118">
		</div>
		<div class="comment-wrapper">
			
				<p>Btw I am referring to a possible problem with shader3.fsh&hellip; val and/or grad does not read in properly, it seems.</p>
			
		</div>
		<div class="comment-meta commentmetadata">
			<a href="#">#</a> by 
			<cite class="fn">
				
				    
				
			</cite> Jan 25, 2017
		</div>
		<div class="reply">
			<a id="1628" class="btn-info comment-reply-link" href="#comment-form" onclick="changeValue('fields[reply_to]', '1628')">Reply</a>
		</div>
	</div>
</li>

<ul class="children">

  

  

  

  

  

  

  

  

  

</ul> 

		    		
		  		
		    		

		    			


<li >
	<div class="comment-body">
		<div class="comment-author vcard">
			<img src="https://www.gravatar.com/avatar/38633b50b57cc6edb8b108753812babd?s=118&d=http://battleofbrothers.com/assets/comment_av_2.png" alt="" class="avatar avatar-64 photo" height="118" width="118">
		</div>
		<div class="comment-wrapper">
			
				<p>I just tried your code again, using your exact same swift/shader code, and yes there is a problem starting from shader3.fsh, ie where you first use the gradient. It works on iOS 9ish, but not on a iOS 10.2.1 device. And I think I found a way to get away the problem on iOS 10.2: do NOT put the textures inside a sprite atlas in a .xcassets folder. If I put the sprite image files outside of a sprite atlas (still inside the .xcassets folder) things work OK/the same way even on iOS 10.2. Maybe the reason is related to app thinning, or the atlas, or something else.</p>
			
		</div>
		<div class="comment-meta commentmetadata">
			<a href="#">#</a> by 
			<cite class="fn">
				
				    
				
			</cite> Jan 25, 2017
		</div>
		<div class="reply">
			<a id="1634" class="btn-info comment-reply-link" href="#comment-form" onclick="changeValue('fields[reply_to]', '1634')">Reply</a>
		</div>
	</div>
</li>

<ul class="children">

  

  

  

  

  

  

  

  

  

</ul> 

		    		
		  		
		    		

		    			


<li >
	<div class="comment-body">
		<div class="comment-author vcard">
			<img src="https://www.gravatar.com/avatar/713649661ac2944ae373c9078d9e24ba?s=118&d=http://battleofbrothers.com/assets/comment_av_9.png" alt="" class="avatar avatar-64 photo" height="118" width="118">
		</div>
		<div class="comment-wrapper">
			
				<p>Interesting, I haven&#39;t tried it yet in iOS10. If it is asset related, that wouldn&#39;t be the first time a sprite atlas vs .xcassets vs image in directory has broken things in SpriteKit. If I find a specific answer, I&#39;ll update it here. Thanks for the note.</p>
			
		</div>
		<div class="comment-meta commentmetadata">
			<a href="#">#</a> by 
			<cite class="fn">
				
				    veeeneck
				
			</cite> Jan 26, 2017
		</div>
		<div class="reply">
			<a id="1640" class="btn-info comment-reply-link" href="#comment-form" onclick="changeValue('fields[reply_to]', '1640')">Reply</a>
		</div>
	</div>
</li>

<ul class="children">

  

  

  

  

  

  

  

  

  

</ul> 

		    		
		  		
		    		

		    			


<li >
	<div class="comment-body">
		<div class="comment-author vcard">
			<img src="https://www.gravatar.com/avatar/41ac589346578bab5977a45662754869?s=118&d=http://battleofbrothers.com/assets/comment_av_9.png" alt="" class="avatar avatar-64 photo" height="118" width="118">
		</div>
		<div class="comment-wrapper">
			
				<p>By the way, it seems the u_sprite_size uniform has been removed as of iOS10, at least according to Apples docs:
<a href="https://developer.apple.com/reference/spritekit/skshader">https://developer.apple.com/reference/spritekit/skshader</a>
&quot;Since the removal of u_sprite_size, if your shader requires the size of the sprite in pixels, you are responsible for creating the necessary uniform or attribute.&quot;
There is sample code for recreating this in the docs themselves, but thought it was worth pointing out.</p>
			
		</div>
		<div class="comment-meta commentmetadata">
			<a href="#">#</a> by 
			<cite class="fn">
				
				    Chris
				
			</cite> Feb 9, 2017
		</div>
		<div class="reply">
			<a id="1652" class="btn-info comment-reply-link" href="#comment-form" onclick="changeValue('fields[reply_to]', '1652')">Reply</a>
		</div>
	</div>
</li>

<ul class="children">

  

  

  

  

  

  

  

  

  

</ul> 

		    		
		  		     
		  	</ol>  
		 

		 <hr />
	  
 
	  <div class="comment-form">
  <div id="respond" class="comment-respond">
    <h3 id="reply-title" class="comment-reply-title">Speak Freely <small></h3>     

    <form class="comment-form" method="POST" action="https://api.staticman.net/v2/entry/veeneck/Battle-of-Brothers-Hugo/master/comments">
        <p class="comment-notes">
          <span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span>
        </p>
          <p class="comment-form-comment">
            <label for="comment">Comment</label> 
            <textarea id="comment" name="fields[body]" class="post-comment-field" placeholder="Your message. Feel free to use Markdown." cols="45" rows="8" maxlength="65525" required="required"></textarea>
          </p>
          <p class="comment-form-author">
            <label for="author">Name <span class="required">*</span></label> 
            <input id="author" name="fields[name]" type="text" class="post-comment-field" placeholder="Your name" required="required" size="30" maxlength="245">
          </p>
          <p class="comment-form-email">
            <label for="email">Email</label> 
            <input id="email" name="fields[email]" type="email" class="post-comment-field" placeholder="Your email address" ize="30" maxlength="100">
          </p>
          <p class="comment-form-url">
            <label for="website">Website</label> 
            <input id="website" name="fields[website]" type="url" class="post-comment-field" placeholder="http://yoursite.com" ize="30" maxlength="200">
          </p>
          <p class="form-submit">
            <input type="submit" id="submit" class="post-comment-field btn submit" value="Submit" id="submit_button" value="Post Comment">
            <input type="hidden" name="options[redirect]" value="http://battleofbrothers.com/sirryan/understanding-shaders-in-spritekit/#post-submitted">
            <input type="hidden" name="options[redirectError]" value="http://battleofbrothers.com/sirryan/understanding-shaders-in-spritekit/#post-error">
            <input type="hidden" name="options[entryId]" value="2015-05-28-understanding-shaders-in-spritekit">
            <input type="hidden" name="options[slug]" value="http://battleofbrothers.com/sirryan/understanding-shaders-in-spritekit/">
            <input type="hidden" name="options[origin]" value="http://battleofbrothers.com/sirryan/understanding-shaders-in-spritekit/">
            <input type="hidden" name="options[parent]" value="2015-05-28-understanding-shaders-in-spritekit">
            <input type="hidden" name="fields[reply_to]" value="">
          </p>      
      </form>
    </div>

    <div id="post-submitted">
      <hr style="margin-bottom: 50px;" />
      <h3 class="comment-reply-title">Thank you</h3>
        <p>Your comment will be published once it has been approved.</p>
        <p><a class="comment-reply-link" href="https://github.com/veeneck/Battle-of-Brothers-Hugo/pulls">Click here</a> to see the pull request you generated.</p>
    </div>
</div>
     </div>
</div> 

    
    <footer class="clear">

  	<div class="bob">
  		<img src="/assets/battleofbrothers.png" />
  	</div>

  	<div >
		<div class="footer_content">
		  	<div class="corner cell">
		  		<p>&nbsp</p>
	  			<img class="ryanfoot" src="/assets/RyanShieldLarge.png" />
	  		</div>
	  		<div class="footerflex">
				<div class="about_contest cell">
					<div class="inner">
						<h5>$25,000. 2 brothers. 1 year. 0 experience.</h5>
						<p>Armed with little to no game development experience, we're setting out to see who can make the best game. 
						In the spirit of learning and following a passion, we're each going to take one year and a $25,000 budget to see how far we can get. 
						It begins on April 7th, 2014. We'll be documenting the journey.</p>
						<p><a href="/">Learn More!</a></p>
					</div>
				</div>
				<div class="links cell">
					<div class="outer">
						<h5>Sir Ryan</h5>
						<p>
							<a class="ryan" href="/sirryan/">Blog</a> /&nbsp; 
							<a class="ryan" href="/sirryan/budget">Budget</a> /&nbsp; 
							<a class="ryan" href="/sirryan/timeline">Timeline</a><span class="social">C</span>
							<a class="white" href="https://twitter.com/veeneck">@veeneck</a></br>
							<a class="ryan" href="/sirryan/contact">Contact</a> /&nbsp; 
							<a class="ryan" href="/sirryan/about">About</a> /&nbsp; 
							<a class="ryan" href="/category/sirryan">Archive</a>
							<span class="social rss">V</span><a class="white" href="http://feeds.feedburner.com/BattleOfBrothers">RSS Feed</a></br>
						</p>
						<h5>Sir Chris</h5>
						<p>
						<a class="chris" href="/sirchris/">Blog</a> /&nbsp; 
						<a class="chris" href="/sirchris/budget">Budget</a> /&nbsp; 
						<a class="chris" href="/sirchris/timeline">Timeline</a>
						<span class="social">C</span><a class="white" href="https://twitter.com/codepaladin">@codepaladin</a></br>
						<a class="chris" href="/sirchris/contact">Contact</a> /&nbsp; 
						<a class="chris" href="/sirchris/about">About</a> /&nbsp; 
						<a class="chris" href="/category/sirchris">Archive</a><span class="social rss">V</span>
						<a class="white" href="http://feeds.feedburner.com/BattleOfBrothers">RSS Feed</a></br></p>
					</div>
				</div>
			</div>
			<div class="corner cell">
				<p>&nbsp</p>
				<img class="chrisfoot" src="/assets/ChrisShieldLarge.png" />
			</div>
		</div>
	</div>
</footer>
  </body>
</html>